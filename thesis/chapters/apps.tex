\appendix

\chapter{Algoritmo de Ramificación y Acotamiento}
\label{app:bb}

\begin{algorithm}[ht]
	\LinesNumbered
	\KwData{
		Problema de maximización lineal $S_0$.
		}
	\KwResult{
		Solución óptima entera $\vec{x}^*$ y valor óptimo $\optilp{z}$.
	}
	\Begin{
		$\mathcal{L} \leftarrow \braces{S_0}$\;
		$\vec{x}^* \leftarrow -\vec{\infty}$\;
		$\optilp{z} \leftarrow -\infty$\;
		\While{$\mathcal{L} \neq \emptyset$}{
			elegir de $\mathcal{L}$ subproblema $S_i$\; \nllabel{p1c9:alg:BB_loop}
			obtener de $S_i$ valor óptimo $z^*_i$ y solución óptima $\vec{x}^i$\;
			$\mathcal{L} \leftarrow \mathcal{L} \setminus \braces{S_i}$\;
			\If{$S_i = \emptyset$ o $z^*_i \leq \optilp{z}$}{
				ir al paso \ref{p1c9:alg:BB_loop}\;
			}
			\If{$\vec{x}^i \in \Z^n$}{
				$\vec{x}^* \leftarrow \vec{x}^i$\;
				$\optilp{z} \leftarrow z^*_i$\;
				ir al paso \ref{p1c9:alg:BB_loop}\;
			}
		    elegir $x^i_j \not \in \Z$ y generar subproblemas $S_{i0}$ y $S_{i1}$ con
			regiones factibles
			$S_{i} \cup \braces{x_j \leq \floor{x^i_j}}$ y
			$S_{i} \cup \braces{x_j \geq \ceil{x^i_j}}$, respectivamente\;
			$\mathcal{L} \leftarrow \mathcal{L} \cup \braces{S_{i1}, S_{i2}}$.
		}
		\Return{$(\vec{x}^*, \optilp{z})$}
	}
	\caption{Ramificación y Acotamiento (adaptado de \cite{fabs})} \label{p1c9:alg:BB}
	\label{algo:bb}
\end{algorithm}

\chapter{Algoritmo extendido del caso infinito}
\label{app:inf:ext}

% TODO: implement algorithm
\begin{algorithm}[ht]
	\LinesNumbered
	\SetKwProg{Fn}{Fn}{\string:}{}
	\SetKwFunction{Bezout}{Bezout}
	\SetKwFunction{NonNegativeIntSol}{NonNegativeIntSol}
	\Fn{\NonNegativeIntSol{$\vec{q}$, $\eta$}}{
		\KwData{\\
			Vector coprimo $\vec{q}$ tal que $q_i \neq 0$ para todo $i \in \braces{1, \ldots, n}$ y
			$q_{n-1} < 0 < q_n$.\\
			Lado derecho $\eta$.
			}
		\KwResult{\\
			Solución entera no negativa $\vec{x}$ a la ecuación lineal diofantina $\vec{q}^T\vec{x} =
			\eta$.
		}
		\Begin{
			$\vec{x} \leftarrow \vec{0}$\;
			$\omega_1 \leftarrow \eta$\;
			\For{$i \leftarrow 1$ \KwTo $n - 2$}{
				$g_{i+1} \leftarrow \gcd{q_{i+1}, \ldots, q_n}$\;
				$x_i', \omega_{i+1}' \leftarrow$ \Bezout{$q_i$, $g_{i+1}$}\;
				$t_i \leftarrow \ceil{-\omega_i x_i' / g_{i+1}}$\;
				$x_i \leftarrow \omega_i x_i' + g_{i+1}t_i$\;
				$\omega_{i+1} \leftarrow \omega_i \omega_{i+1}' - q_i t_i$\;
				\For{$j \leftarrow i$ \KwTo $n - 2$}{
					$q_{j+1} \leftarrow q_{j+1}/g_{i+1}$\;
				}
			}

			$x_{n-1}', x_n' \leftarrow$ \Bezout{$q_{n-1}$, $q_n$}\;
			$b_1 \leftarrow -\omega_{n-1} x_{n-1}' / q_n$\;
			$b_2 \leftarrow -\omega_{n-1} x_n' / q_{n-1}$\;
			$t_{n-1} \leftarrow \ceil{\max\lbrace b_1, b_2\rbrace}$\;
			$x_{n-1} \leftarrow \omega_{n-1}x_{n-1}' + q_nt_{n-1}$\;
			$x_{n} \leftarrow \omega_{n-1}x_{n}' - q_{n-1}t_{n-1}$\;

			\Return{$\vec{x}$}
		}
	}
	\caption{Algoritmo para obtener soluciones enteras no negativas a la ecuación lineal diofantina
	$\vec{q}^T\vec{x} = \eta$, dados ciertos supuestos sobre $\vec{q}$.}
	\label{algo:inf:ext}
\end{algorithm}
