\chapter{El caso infinito}

% TODO: resumen del capítulo

\section{Una restricción presupuestaria}
\noindent
Los puntos enteros que se encuentran en la $\eta$-ésima capa entera satisfacen la ecuación lineal
diofantina
\begin{equation}
	\label{eq:dioph}
	\vec{q}^T\vec{x} = \vec{q}_1\vec{x}_1 + \vec{q}_2\vec{x}_2 + \cdots + \vec{q}_n\vec{x}_n = \eta.
\end{equation}
En la sección de Teoría de Números mostramos bajo qué condiciones existen soluciones a este tipo de
ecuaciones y también cómo construirlas cuando solamente tenemos dos incógnitas. Partimos de la
observación que podemos resolver recursivamente esta ecuación. Definamos, por conveniencia,
$g_1 \coloneq \gcd{\vec{q}_1, \ldots, \vec{q}_n}$ y también $\omega_1 \coloneq \eta$. Como
$\vec{q}_1, \ldots, \vec{q}_n$ son coprimos, sabemos que $g_1 = 1$. Además, definamos
\begin{equation*}
	\omega_2 \coloneq \frac{\vec{q}_2}{g_2 \cdot g_1}\vec{x}_1 + \cdots + \frac{\vec{q}_n}{g_2 \cdot
	g_1}\vec{x}_n,
\end{equation*}
donde $g_2 \coloneq \gcd{\vec{q}_2/g_1, \ldots, \vec{q}_n/g_1}$. Así, la ecuación (\ref{eq:dioph})es
equivalente a
\begin{equation}
	\label{eq:dioph:first-step}
	\frac{q_1}{g_1}\vec{x}_1 + g_2\omega_2 = \omega_1.
\end{equation}
Observemos que
\begin{equation*}
	\gcd{\frac{\vec{q}_1}{g_1}, g_2}
	= \gcd{\frac{\vec{q}_1}{g_1}, \gcd{\frac{\vec{q}_2}{g_1}, \ldots, \frac{\vec{q}_n}{g_1}}}
	= \gcd{\vec{q}_1, \vec{q}_2, \ldots, \vec{q}_n} = 1.
\end{equation*}
Por lo tanto, existen soluciones enteras para todo $\omega_1 \in \Z$. Como $\vec{q}_1/g_1$ y $g_2$
son coprimos, encontramos que sus coeficientes de Bézout asociados (c.f. Definición
\ref{prerreq:def:bezout}) $x_1', \omega_2'$ son soluciones particulares de la ecuación
\begin{equation*}
	\frac{q_1}{g_1}\vec{x}_1 + g_2\omega_2 = 1.
\end{equation*}
Deducimos que las soluciones de la ecuación (\ref{eq:dioph:first-step}) están dadas por
\begin{equation*}
	\begin{cases}
		\vec{x}_1 = \omega_1x_1' + g_2t_1, \\
		\omega_2 = \omega_1\omega_2' - \frac{q_1}{g_1}t_1,
	\end{cases}
\end{equation*}
donde $t_1 \in \Z$ es una variable libre. La restricción de no negatividad $\vec{x}_1 \geq 0$ se debe
satisfacer, así que
\begin{equation*}
	t_1 \geq \left\lceil -\frac{\omega_1x_1'}{g_2} \right\rceil.
\end{equation*}

Para el siguiente paso de la recursión fijamos $t_1$ y resolvemos la ecuación
\begin{equation}
	\label{eq:dioph:second-step}
	\frac{\vec{q}_2}{g_2 \cdot g_1}\vec{x}_2 +
	\frac{\vec{q}_3}{g_2 \cdot g_1}\vec{x}_3 +
	\cdots +
	\frac{\vec{q}_n}{g_2 \cdot g_1}\vec{x}_n
	= \omega_2.
\end{equation}
Como $g_2 = \gcd{\vec{q}_2/g_1, \ldots, \vec{q}_n}$, sabemos del Corolario \ref{prerreq:cor:gcd} que
\begin{equation*}
	\gcd{\frac{\vec{q}_2}{g_2 \cdot g_1}, \ldots, \frac{\vec{q}_n}{g_2 \cdot g_1}} = 1.
\end{equation*}
En el mismo espíritu que el primer paso de la recursión, definimos
\begin{equation*}
	\omega_3 \coloneq \frac{\vec{q}_3}{g_3 \cdot g_2 \cdot g_1}\vec{x}_1 + \cdots + \frac{\vec{q}_n}{g_3
	\cdot g_2 \cdot g_1}\vec{x}_n,
\end{equation*}
donde
\begin{equation*}
	g_3 \coloneq  \gcd{\frac{\vec{q}_3}{g_2 \cdot g_1}, \ldots, \frac{\vec{q}_n}{g_2 \cdot g_1}}.
\end{equation*}
Por lo que la ecuación (\ref{eq:dioph:second-step}) es equivalente a
\begin{equation}
	\label{eq:dioph:second-step:short}
	\frac{\vec{q}_2}{g_2 \cdot g_1}\vec{x}_2 + g_3\omega_3 = \omega_2.
\end{equation}
Nuevamente, tenemos
\begin{equation*}
	\gcd{\frac{\vec{q}_2}{g_2 \cdot g_1}, g_3} = 1,
\end{equation*}
y entonces (\ref{eq:dioph:second-step:short}) tiene una infinidad de soluciones para todo $\omega_2 \in
\Z$, las cuales están dadas por
\begin{equation*}
	\begin{cases}
		\vec{x}_2 = \omega_2x_2' + g_3t_2, \\
		\omega_3 = \omega_2\omega_3' - \frac{q_2}{g_2 \cdot g_1}t_2,
	\end{cases}
\end{equation*}
donde $t_2 \in \Z$ es una variable libre, y $x_2', \omega_3'$ son los coeficientes de Bézout
asociados a $\frac{\vec{q}_2}{g_2 \cdot g_2}$ y $g_3$, respectivamente. Por la restricción de no
negatividad $\vec{x}_2 \geq 0$ se debe satisfacer
\begin{equation*}
	t_2 \geq \left\lceil -\frac{\omega_2x_2'}{g_3} \right\rceil.
\end{equation*}

De manera general, para $i \in \lbrace 1, \ldots, n - 2 \rbrace$, el $i$-ésimo paso de la recursión
provee las soluciones
\begin{equation}
	\label{eq:recurrence}
	\begin{cases}
		\vec{x}_i = \omega_ix_i' + g_{i + 1}t_i, \\
		\omega_{i + 1} = \omega_i\omega_{i + 1}' - \frac{\vec{q}_i}{\prod_{j=1}^{i}g_j}t_i,
	\end{cases}
\end{equation}
donde $t_i \in \Z$ satisface, debido a la restricción de no negatividad $\vec{x}_i \geq 0$,
\begin{equation}
	\label{eq:param-lb}
	t_i \geq \left\lceil -\frac{\omega_ix_i'}{g_{i + 1}} \right\rceil.
\end{equation}

En el último paso obtenemos la ecuación lineal diofantina
\begin{equation}
	\label{eq:last-equation}
	\frac{q_{n-1}}{\prod_{j=1}^{n-1}g_j}\vec{x}_{n-1} +
	\frac{q_{n}}{\prod_{j=1}^{n-1}g_j}\vec{x}_n
	= \omega_{n-1}.
\end{equation}
Por construcción, los coeficientes de $\vec{x}_{n - 1}$ y $\vec{x}_n$ son coprimos. Las soluciones
están dadas por
\begin{equation}
	\label{eq:last-solution}
	\begin{cases}
		\vec{x}_{n-1} = \omega_{n-1}x_{n-1}' + \frac{\vec{q}_n}{\prod_{j=1}^{n-1}g_j}t_{n-1}, \\
		\vec{x}_n = \omega_{n-1}x_n' - \frac{\vec{q}_{n-1}}{\prod_{j=1}^{n-1}g_j}t_{n-1},
	\end{cases}
\end{equation}
Para que ahora se satisfagan las condiciones de no negatividad de $\vec{x}_{n-1}$ y de $\vec{x}_n$,
encontramos que la variable libre $t_{n-1} \in \Z$ debe cumplir ciertas desigualdades según los
signos de $q_{n-1}$ y de $q_n$. Definamos, por conveniencia,
\begin{equation}
	\label{eq:lr-bounds}
	b_1 \coloneq -\frac{\omega_{n-1}x_{n-1}'}{\vec{q}_n} \cdot \prod_{j=1}^{n-1}g_j,
	\quad b_2 \coloneq \frac{\omega_{n-1}x_{n}'}{\vec{q}_{n-1}} \cdot \prod_{j=1}^{n-1}g_j.
\end{equation}
Entonces se verifica que
\begin{equation}
	\label{eq:feasible-param}
	t_{n-1} \in 
	\begin{cases}
		\big[ \lceil b_1 \rceil, \lfloor b_2 \rfloor \big] & \text{si } 0 < \vec{q}_{n-1}, \vec{q}_n, \\
		\big[ \lceil b_2 \rceil, \lfloor b_1 \rfloor \big] & \text{si } \vec{q}_{n-1}, \vec{q}_n < 0, \\
		\big[ \lceil \max\lbrace b_1 ,  b_2 \rbrace \rceil, \infty \big) & \text{si } \vec{q}_{n-1}
		< 0 < \vec{q}_n, \\
		\big( -\infty, \lfloor \min\lbrace b_1, b_2\rbrace \rfloor \big] & \text{si } \vec{q}_n < 0
		< \vec{q}_{n-1}.
	\end{cases}
\end{equation}

\begin{lemma}
	\label{lemma:t-existence}
	Existe un vector $\vec{t} \in \Z^{n-1}$ que satisface ambos (\ref{eq:param-lb}) y
	(\ref{eq:feasible-param}).
\end{lemma}
\begin{proof}
	Tenemos cuatro casos, pero observemos que los dos en donde $\vec{q}_{n - 1}$ y $\vec{q}_n$
	tienen signo distinto no son difíciles: si $\vec{q}_{n - 1} <0 < \vec{q}_n$, entonces el vector
	$\vec{t} \in \Z^{n-1}$ dado por
	\begin{equation*}
		\vec{t}_i \coloneq \begin{cases}
			\left\lceil -\frac{\omega_i x_i'}{g_{i + 1}} \right\rceil, & i < n - 1, \\
			\lceil \max\lbrace b_1, b_2 \rbrace \rceil, & i = n - 1,
		\end{cases}
	\end{equation*}
	satisface ambos (\ref{eq:param-lb}) y (\ref{eq:feasible-param}). El caso $\vec{q}_n < 0 <
	\vec{q}_{n - 1}$ es completamente similar.

	Ahora bien, supongamos que $0 < \vec{q}_{n - 1}, \vec{q}_n$. Podemos suponer sin pérdida de
	generalidad que $\vec{q}_{n - 2} < 0$. En efecto, como $\vec{q}_i < 0$ para alguna $i \in
	\lbrace 2, \ldots, n \rbrace$, somos capaces permutar las entradas $i$ y $n - 2$ de $\vec{q}$ en
	el problema (\ref{theory:formulation}). Observemos que
	\begin{align*}
		b_2 - 1 &\leq \lfloor b_2 \rfloor \leq b_2, \\
		b_1 &\leq \lceil b_1 \rceil \leq b_1 + 1.
	\end{align*}
	De donde obtenemos
	\begin{equation*}
		b_2 - b_1 - 2 \leq \lfloor b_2 \rfloor - \lceil b_1 \rceil \leq b_2 - b_1.
	\end{equation*}
	Así pues, para que el intervalo $[\lceil b_1 \rceil, \lfloor b_2 \rfloor]$ esté bien definido,
	es suficiente con mostrar que existe un escalar $\omega_{n - 1}$ que satisfaga $b_2 - b_1 \geq
	2$. Tenemos
	\begin{equation}
		\label{proof:b-sub}
		b_2 - b_1 = \omega_{n - 1}\prod_{j = 1}^{n-1}g_j \cdot
			\left(\frac{x_{n-1}'}{\vec{q}_n} + \frac{x_n'}{\vec{q}_{n - 1}}\right)
	\end{equation}
	Como $x_{n - 1}'$ y $x_n'$ son coeficientes de Bézout asociados a los dos coeficientes en
	(\ref{eq:last-equation}) que son coprimos, se cumple
	\begin{equation*}
		\frac{\vec{q}_{n - 1}}{\prod_{j = 1}^{n-1}g_j}x_{n-1}' +
		\frac{\vec{q}_{n}}{\prod_{j = 1}^{n-1}g_j}x_{n}' = 1,
	\end{equation*}
	lo que implica que
	\begin{equation*}
		\frac{x_{n-1}'}{\vec{q}_n} + \frac{x_n'}{\vec{q}_{n - 1}} = \frac{\prod_{j =
		1}^{n-1}g_j}{\vec{q}_{n-1}\vec{q}_n}.
	\end{equation*}
	Sustituyendo en (\ref{proof:b-sub}),
	\begin{equation}
		\label{proof:omega-sub}
		b_2 - b_1 = \omega_{n-1}\cdot \frac{\prod_{j=1}^{n-1}g_j^2}{\vec{q}_{n-1}\vec{q}_n} \geq 2
		\iff \omega_{n-1} \geq 2\frac{\vec{q}_{n-1}\vec{q}_n}{\prod_{j=1}^{n-1}g_j^2}.
	\end{equation}
	De (\ref{eq:recurrence}) sabemos que
	\begin{equation*}
		\omega_{n-1} = \omega_{n-2}\omega_{n-1}' -
		\frac{\vec{q}_{n-2}}{\prod_{j=1}^{n-2}g_j}t_{n-2}.
	\end{equation*}
	Sustituyendo en (\ref{proof:omega-sub}), usando el hecho de que $\vec{q}_{n-2} < 0$ y despejando
	$t_{n-2}$, encontramos que $\lceil b_2 \rceil - \lfloor b_1 \rfloor \geq 0$ si
	\begin{equation*}
		t_{n-2} \geq \frac{\omega_{n-2}\omega_{n-1}'}{\vec{q}_{n-2}}\prod_{j=1}^{n-2}g_j
		- 2\frac{\vec{q}_{n-1}\vec{q}_n}{\vec{q}_{n-2}g_{n-1}^2}
		\prod_{j=1}^{n-2}g_j^{-1}
	\end{equation*}
	Llamemos $c$ al lado derecho de esta desigualdad. Así pues, definimos el vector
	$\vec{t} \in \Z^{n-1}$ de manera que
	\begin{equation*}
		\vec{t}_i \coloneq \begin{cases}
			\left\lceil -\frac{\omega_i x_i'}{\vec{q}_i} \right\rceil, & i < n - 2, \\[1em]
			\left\lceil \max\left\lbrace -\frac{\omega_ix_i'}{\vec{q}_i}, c \right\rbrace
			\right\rceil, & i = n -2, \\[0.8em]
			\lceil b_1 \rceil, & i = n - 1.
		\end{cases}
	\end{equation*}
	Se verifica que $\vec{t}$ satisface ambos (\ref{eq:param-lb}) y (\ref{eq:feasible-param}).
	Finalmente, el caso $\vec{q}_{n-1}, \vec{q}_n < 0$ es completamente similar.
\end{proof}

En síntesis, por el Teorema (\ref{theory:th:feasibility}) sabemos que la solución se encuentra en
la $\eta$-ésima capa entera. Por lo tanto, debemos encontrar una solución no negativa a la ecuación
lineal diofantina (\ref{eq:dioph}). Por el Lema \ref{lemma:t-existence} sabemos que existe un vector
$\vec{t} \in \Z^{n-1}$ que satisface ambos (\ref{eq:param-lb}) y (\ref{eq:feasible-param}). Si
definimos $\vec{x}$ como lo indican (\ref{eq:recurrence}) y (\ref{eq:last-solution}) usando
$\vec{t}$, entonces $\vec{x}$ es una solución entera no negativa. Observemos que podemos construir
los vectores $\vec{t}$ y $\vec{x}$ simúltaneamente. De esta manera, obtenemos el siguiente Teorema.

\begin{theorem}
	El problema (\ref{theory:formulation}) se puede resolver a través de encontrar la solución de
	una ecuación lineal diofantina en $n$ incógnitas.
\end{theorem}

\section{Múltiples restricciones}
\noindent
Ahora consideremos el problema
\begin{subequations}
	\label{formulation:multiple}
	\begin{align}
		\max_{\vec{x} \in \Z^n} \quad
			& \vec{p}^T\vec{x}, \label{formulation:multiple:objective} \\
		\text{s.a.} \quad
			& \vec{p}^T\vec{x} \leq u, \label{formulation:multiple:constraint:budget} \\
			& A\vec{p} \leq \vec{b}, \label{formulation:multiple:constraints} \\
			& \vec{x} \geq \vec{0}. \nonumber
	\end{align}
\end{subequations}
Nuevamente, añadimos la condición de que $\vec{p}$ sea esencialmente entero y dejamos que $\vec{q}$
sea su múltiplo coprimo con $\vec{q}_i < 0$ para alguna $i \in \lbrace 2, \ldots, n \rbrace$.
Ciertamente, la solución ahora no se encuentra necesariamente en la $\eta$-ésima capa entera. Por
ejemplo, si dejamos que $A \coloneq \vec{q}^T$ y $b \coloneq u - m$, la solución se encontrará en la
$\xi$-ésima capa entera, donde
\begin{equation*}
	\xi \coloneq \left\lfloor \frac{u}{m} - 1 \right\rfloor < \eta.
\end{equation*}
No obstante, si el problema (\ref{formulation:multiple}) es factible, sabemos que la solución se
encontrará en alguna capa entera con parámetro $k \in \lbrace \eta, \eta - 1, \ldots \rbrace$, pues
todavía contamos con una restricción presupuestaria que se debe satisfacer.

En esta sección buscamos establecer una relación lineal entre $\vec{t}$ y $\vec{x}$ que nos permita
deshacernos de la restricción presupuestaria y reducir la dimensión del problema tanto en dimensión
como en número de restricciones. Para ello, nos fijamos en la $k$-ésima capa entera y resolvemos 
la ecuación lineal diofantina
\begin{equation*}
	\vec{q}_1\vec{x}_1 + \cdots \vec{q}_n\vec{x}_n = k.
\end{equation*}
Observemos que la única diferencia entre esta ecuación y (\ref{eq:dioph}) es el lado derecho de la
igualdad. Entonces, podemos hacer uso de los resultados anteriores si definimos $\omega_1 \coloneq
k$ en vez de $\omega_1 \coloneq \eta$. A partir de esto último junto con (\ref{eq:recurrence}),
descubrimos una relación de recurrencia que los coeficientes $\omega_i$ deben satisfacer:
\begin{equation}
	\label{eq:omega-recurrence}
	\begin{cases}
		\omega_1 &= k, \\
		\omega_{i + 1} &= \omega_i \cdot \omega_{i + 1}' - \frac{\vec{q}_i}{\prod_{\ell=1}^{i}g_\ell} \cdot t_i.
	\end{cases}
\end{equation}
\begin{lemma}
	La forma cerrada de la relación de recurrencia (\ref{eq:omega-recurrence}) está dada por
	\begin{equation}
		\label{eq:omega-formula}
		\omega_i =
		k \cdot \prod_{j=2}^{i} \omega_j'
		- \sum_{j=1}^{i - 1}\frac{\vec{q}_j}{\prod_{\ell=1}^{j}g_\ell}
		\cdot \prod_{\ell=j+2}^{i}\omega_\ell' \cdot t_j.
	\end{equation}
\end{lemma}
\begin{proof}
	Lo demostramos inductivamente. Observemos que
	\begin{equation*}
		\omega_1 =
		k \cdot \prod_{j=2}^{1} \omega_j'
		- \sum_{j=1}^{0}\frac{\vec{q}_j}{\prod_{\ell=1}^{j}g_\ell}
		\cdot \prod_{\ell=j+2}^{1}\omega_\ell' \cdot t_j
		= k,
	\end{equation*}
	debido a que definimos el producto vacío como 1 y la suma vacía como 0. Supongamos
	inductivamente que (\ref{eq:omega-formula}) se satisface para alguna $i \in \N$. Entonces,
	tenemos
	\begin{align*}
		\omega_{i + 1}
		&=
		k \cdot \prod_{j=2}^{i + 1} \omega_j'
		- \sum_{j=1}^{i}\frac{\vec{q}_j}{\prod_{\ell=1}^{j}g_\ell}
		\cdot \prod_{\ell=j+2}^{i + 1}\omega_\ell' \cdot t_j \\
		&=
		k \cdot \prod_{j=2}^{i} \omega_j' \cdot \omega_{i+1}
		- \sum_{j=1}^{i - 1}\frac{\vec{q}_j}{\prod_{\ell=1}^{j}g_\ell}
		\cdot \prod_{\ell=j+2}^{i}\omega_\ell' \cdot t_j \cdot \omega_{i + 1}'
		- \frac{\vec{q}_i}{\prod_{\ell = 1}^{i}g_\ell}
		\cdot \prod_{\ell = i + 2}^{i + 1}\omega_\ell' \cdot t_i \\
		&= 
		\left( k \cdot \prod_{j=2}^{i} \omega_j'
		- \sum_{j=1}^{i - 1}\frac{\vec{q}_j}{\prod_{\ell=1}^{j}g_\ell}
		\cdot \prod_{\ell=j+2}^{i}\omega_\ell' \cdot t_j \right) \omega_{i+1}'
		- \frac{\vec{q}_i}{\prod_{\ell = 1}^{i}g_\ell} \cdot t_i  \\
		&= \omega_i \cdot \omega_{i + 1}' - \frac{\vec{q}_i}{\prod_{\ell = 1}^{i}g_\ell} \cdot t_i.
	\end{align*}
	Por el principio de inducción se sigue que (\ref{eq:omega-formula}) satisface
	(\ref{eq:omega-recurrence}) para todo $i \in \N$. Así, esta fórmula es la forma cerrada de la
	relación de recurrencia propuesta.
\end{proof}

Por conveniencia, definimos los coeficientes $m_{ij} \in \mathbb{Z}$ con $i > j$ como
\begin{equation}
	\label{phase-2:eq:coeffs}
	m_{ij} \coloneq \frac{\vec{q}_j}{\prod_{\ell = 1}^{j}g_\ell} \cdot \prod_{\ell = j +
	2}^{i}\omega_\ell'.
\end{equation}
Así pues, juntando esto último con \ref{eq:recurrence}, obtenemos para $i \in \{1, \ldots, n -
2\}$, 
\begin{align}
	\vec{x}_i &= \omega_i \cdot x_i' + g_{i + 1}\vec{t}_i \nonumber \\
		&= k \cdot \prod_{j=2}^{i}\omega_j' \cdot x_i' - \sum_{j=1}^{i - 1}m_{ij}x_i'
		\vec{t}_j + g_{i + 1}\vec{t}_i \label{eq:x:i}.
\end{align}
Similarmente, sustituyendo en \ref{eq:last-solution},
\begin{subequations}
	\label{eq:x:last}
	\begin{align}
		\vec{x}_{n-1} &= k \cdot \prod_{j=2}^{n-1} \omega_j' \cdot x_{n-1}' - \sum_{j=1}^{n-2}
		m_{n-1,j}x_{n-1}' \vec{t}_j + \frac{\vec{q}_n}{\prod_{j=1}^{n-2}g_j} \vec{t}_{n-1}, \\
		\vec{x}_{n} &= k \cdot \prod_{j=2}^{n-1} \omega_j' \cdot x_{n}' - \sum_{j=1}^{n-2}
		m_{n,j}x_{n}' \vec{t}_j - \frac{\vec{q}_{n - 1}}{\prod_{j=1}^{n-2}g_j} \vec{t}_{n-1}.
	\end{align}
\end{subequations}

Con este trabajo anterior, ya podemos establecer una relación lineal entre $\vec{t} \in \Z^{n-1}$ y
$\vec{x} \in \Z^n$. Definimos $\vec{\omega} \in \Z^n$ como
\begin{equation}
	\label{eq:vec-omega}
	\vec{\omega}_i \coloneq \vec{x}_i' \cdot \prod_{j = 2}^{\min{\lbrace i, n - 1 \rbrace}}\omega_j'.
\end{equation}
También definimos la matriz $M \in \Z^{n \times (n - 1)}$ a través de
\begin{equation}
	\label{eq:mat-T}
	M_{ij} \coloneq \begin{cases}
		m_{ij}x_i', &\quad j < i, \\
		g_{i + 1},  &\quad i = j < n - 1, \\
		\frac{\vec{q}_n}{\prod_{k=1}^{n-2}g_k}, &\quad i = j = n - 1, \\
		-\frac{\vec{q}_{n-1}}{\prod_{k=1}^{n-2}g_k}, &\quad i = n, j = n - 1, \\
		0, &\quad \text{e.o.c.}
	\end{cases}
\end{equation}
De (\ref{eq:x:i}) y (\ref{eq:x:last}) obtenemos
\begin{equation}
	\label{eq:transf}
	\vec{x} = k\vec{\omega} - M\vec{t}.
\end{equation}

Consecuentemente, de la restricción (\ref{formulation:multiple:constraints}) obtenemos
\begin{equation}
	A\vec{x} \leq \vec{b} \iff AT\vec{t} \geq kA\vec{\omega} - \vec{b}.
\end{equation}
Dependiendo de los signos de $\vec{q}_{n-1}$ y de $\vec{q}_n$ (c.f. \ref{eq:feasible-param})
obtenemos un problema de maximización equivalente a (\ref{formulation:multiple}). Por ejemplo, si
$\vec{q}_{n-1} < 0 < \vec{q}_n$, el problema equivalente es
\begin{subequations}
	\label{formulation:lattice}
	\begin{align}
		\max_{k \in \Z, \vec{t} \in \Z^{n-1}}
			& k, \\
		\text{s.a.} \quad
			& k \leq \eta, \label{lattice:c-layer} \\
			& AM\vec{t} \geq kA\vec{\omega}' - \vec{b}, \label{lattice:constraints} \\
			& \vec{t}_i \geq \left\lceil \frac{-\vec{\omega}_i'}{g_{i + 1}} \right\rceil, \quad
			\forall i \in \lbrace 1, \ldots, n - 2 \rbrace, \label{lattice:pos-1} \\
			& \vec{t}_{n - 1} \geq \left\lceil \max\lbrace b_1, b_2 \rbrace \right\rceil,
			\label{lattice:pos-2},
	\end{align}
\end{subequations}
donde $b_1$ y $b_2$ están definidos en (\ref{eq:lr-bounds}). Podemos decir un par de cosas acerca de
este nuevo problema. La primera restricción corresponde a la restricción presupuestaria, y todavía es
ortogonal al vector objetivo. El politopo generado por la segunda restricción parece ser que es
dilatado o expandido en función de $k$. Naturalmente, las direcciones en donde se dilata y donde se
expande depende de los coeficientes de la matriz de restricciones $A$. Finalmente, las últimas dos
restricciones, como lo hemos mostrado en el Lema \ref{lemma:t-existence}, son suficientes para
asegurar no negatividad de $\vec{x}$.

A pesar de que sigamos teniendo una restricción ortogonal al vector objetivo, esta parece ser más
fácil de manejar.

% XXX: esto es experimental
Supongamos, sin pérdida de generalidad que $A$ tiene $m$ renglones linealmente independientes. De
\cite{alex} sabemos que $A$ tiene una forma normal de Hermite, de manera que $[B, 0] \coloneq AU$ es una
matriz no singular, donde $U \in \Z^{n \times n}$ es una matriz unimodular. Del Corolario 5.3b de
\cite{alex}, deducimos que si $k$ es el máximo entero que satisface
\begin{align}
	k &\leq \eta, \\
	B^{-1}\left(k A\vec{\omega}' - \vec{b}\right) \in \Z^m,
\end{align}
entonces podemos definir
\begin{equation}
	\vec{\tilde{y}} \coloneq U\begin{pmatrix}
		\inv{B}\left(kA\vec{\omega}' - \vec{b}\right)
		\\ 0
	\end{pmatrix} \in \Z^n.
\end{equation}
Observemos que se satisface $A\vec{\tilde{y}} = kA\vec{\omega} - \vec{b}$. Finalmente, nos
encontramos con un problema de factibilidad
\begin{align*}
	T\vec{t} = \vec{\tilde{y}}, \\
	\vec{t}_i \geq \left\lceil -\frac{\vec{\omega}_i'}{g_{i + 1}} \right\rceil.
\end{align*}
